<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Xelloxx - Marketplace Bot & Source Code</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #080c14;
  --bg2: #0d1525;
  --card: #111827;
  --border: rgba(255,150,0,0.15);
  --accent: #ff6a00;
  --accent2: #ff9500;
  --text: #e8eaf0;
  --muted: #8892a4;
  --glow: rgba(255,106,0,0.3);
}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:'Syne',sans-serif;overflow-x:hidden}

/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:100;padding:1rem 2rem;display:flex;align-items:center;justify-content:space-between;background:rgba(8,12,20,0.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.logo{font-size:1.6rem;font-weight:800;letter-spacing:-1px}
.logo span{color:var(--accent)}
.nav-links{display:flex;gap:1.5rem;align-items:center}
.nav-links a{color:var(--muted);text-decoration:none;font-size:.9rem;transition:.2s}
.nav-links a:hover{color:var(--text)}
.btn{padding:.55rem 1.3rem;border-radius:8px;font-family:'Syne',sans-serif;font-weight:700;cursor:pointer;transition:.2s;text-decoration:none;font-size:.85rem;border:none}
.btn-primary{background:var(--accent);color:#fff}
.btn-primary:hover{background:var(--accent2);transform:translateY(-1px)}
.btn-outline{background:transparent;color:var(--text);border:1px solid var(--border)}
.btn-outline:hover{border-color:var(--accent);color:var(--accent)}
.hamburger{display:none;flex-direction:column;gap:5px;cursor:pointer;padding:4px}
.hamburger span{width:24px;height:2px;background:var(--text);transition:.3s}

/* HERO */
.hero{min-height:100vh;display:flex;align-items:center;justify-content:center;text-align:center;padding:6rem 2rem 4rem;position:relative;overflow:hidden}
.hero-bg{position:absolute;inset:0;background:radial-gradient(ellipse 80% 60% at 50% 0%,rgba(255,106,0,0.12) 0%,transparent 70%)}
.hero-grid{position:absolute;inset:0;background-image:linear-gradient(rgba(255,255,255,.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.02) 1px,transparent 1px);background-size:50px 50px;mask-image:radial-gradient(ellipse 80% 60% at center,black 30%,transparent 80%)}
.badge{display:inline-block;padding:.4rem 1.2rem;background:rgba(255,106,0,.1);border:1px solid rgba(255,106,0,.3);border-radius:100px;font-size:.8rem;color:var(--accent);font-family:'Space Mono',monospace;margin-bottom:1.5rem;letter-spacing:1px}
.hero h1{font-size:clamp(2.5rem,7vw,5.5rem);font-weight:800;line-height:1.05;margin-bottom:1.5rem;letter-spacing:-2px}
.hero h1 .hl{color:var(--accent)}
.hero p{color:var(--muted);font-size:1.1rem;max-width:520px;margin:0 auto 2.5rem;line-height:1.7}
.hero-btns{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap}
.stats-row{display:flex;gap:3rem;justify-content:center;margin-top:4rem;flex-wrap:wrap}
.stat{text-align:center}
.stat-num{font-size:2rem;font-weight:800;color:var(--accent);font-family:'Space Mono',monospace}
.stat-label{font-size:.8rem;color:var(--muted);margin-top:.2rem}

/* FLASH SALE */
.flash-sale{padding:3rem 2rem;max-width:1200px;margin:0 auto}
.section-header{display:flex;align-items:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}
.section-title{font-size:1.6rem;font-weight:800;display:flex;align-items:center;gap:.6rem}
.fire{font-size:1.3rem}
.countdown{display:flex;gap:.5rem;align-items:center;margin-left:auto}
.cd-box{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:.4rem .7rem;text-align:center;min-width:50px}
.cd-num{font-size:1.3rem;font-weight:700;color:var(--accent);font-family:'Space Mono',monospace}
.cd-label{font-size:.6rem;color:var(--muted)}
.cd-sep{color:var(--accent);font-size:1.2rem;font-weight:700}

/* FILTERS */
.filters{padding:2rem 2rem 0;max-width:1200px;margin:0 auto}
.filter-row{display:flex;gap:.7rem;flex-wrap:wrap;align-items:center}
.search-box{display:flex;background:var(--card);border:1px solid var(--border);border-radius:10px;overflow:hidden;flex:1;min-width:200px;max-width:400px}
.search-box input{background:none;border:none;padding:.7rem 1rem;color:var(--text);font-family:'Syne',sans-serif;font-size:.9rem;flex:1;outline:none}
.search-box button{padding:.7rem 1rem;background:var(--accent);border:none;color:#fff;cursor:pointer;font-size:.9rem}
.filter-btn{padding:.5rem 1rem;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;font-family:'Syne',sans-serif;font-size:.85rem;transition:.2s}
.filter-btn.active,.filter-btn:hover{background:var(--accent);color:#fff;border-color:var(--accent)}

/* PRODUCTS GRID */
.products-section{padding:2rem;max-width:1200px;margin:0 auto}
.products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:1.5rem}
.product-card{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden;transition:.3s;cursor:pointer;position:relative}
.product-card:hover{border-color:rgba(255,106,0,.4);transform:translateY(-4px);box-shadow:0 20px 40px rgba(0,0,0,.4)}
.card-img{width:100%;height:160px;object-fit:cover;display:block}
.card-img-placeholder{width:100%;height:160px;background:linear-gradient(135deg,#1a2035,#0d1525);display:flex;align-items:center;justify-content:center;font-size:2.5rem}
.card-badge{position:absolute;top:.8rem;right:.8rem;padding:.25rem .7rem;border-radius:100px;font-size:.7rem;font-weight:700;font-family:'Space Mono',monospace}
.badge-sale{background:var(--accent);color:#fff}
.badge-free{background:#10b981;color:#fff}
.card-body{padding:1.2rem}
.card-cat{font-size:.7rem;color:var(--accent);font-family:'Space Mono',monospace;letter-spacing:1px;margin-bottom:.5rem;text-transform:uppercase}
.card-name{font-size:1rem;font-weight:700;margin-bottom:.5rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.card-desc{font-size:.8rem;color:var(--muted);line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;margin-bottom:1rem}
.card-footer{display:flex;align-items:center;justify-content:space-between}
.price-box{}
.price-current{font-size:1.1rem;font-weight:800;color:var(--accent);font-family:'Space Mono',monospace}
.price-old{font-size:.75rem;color:var(--muted);text-decoration:line-through;font-family:'Space Mono',monospace}
.btn-buy{padding:.45rem 1rem;background:var(--accent);color:#fff;border:none;border-radius:8px;cursor:pointer;font-family:'Syne',sans-serif;font-weight:700;font-size:.8rem;transition:.2s}
.btn-buy:hover{background:var(--accent2);transform:scale(1.05)}
.card-type{display:inline-block;padding:.2rem .5rem;border-radius:4px;font-size:.65rem;font-family:'Space Mono',monospace;margin-bottom:.5rem}
.type-rent{background:rgba(99,102,241,.15);color:#818cf8;border:1px solid rgba(99,102,241,.3)}
.type-sell{background:rgba(16,185,129,.15);color:#34d399;border:1px solid rgba(16,185,129,.3)}

/* FOOTER */
footer{padding:3rem 2rem;border-top:1px solid var(--border);text-align:center;color:var(--muted);font-size:.85rem}
footer .logo-footer{font-size:1.5rem;font-weight:800;margin-bottom:1rem}
footer .logo-footer span{color:var(--accent)}

/* MODAL */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(10px);z-index:1000;display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;pointer-events:none;transition:.3s}
.modal-overlay.open{opacity:1;pointer-events:all}
.modal{background:var(--card);border:1px solid var(--border);border-radius:20px;width:100%;max-width:560px;overflow:hidden;transform:translateY(20px);transition:.3s}
.modal-overlay.open .modal{transform:translateY(0)}
.modal-img{width:100%;height:200px;object-fit:cover}
.modal-body{padding:1.5rem}
.modal-cat{font-size:.7rem;color:var(--accent);font-family:'Space Mono',monospace;letter-spacing:1px;text-transform:uppercase;margin-bottom:.5rem}
.modal-title{font-size:1.4rem;font-weight:800;margin-bottom:.8rem}
.modal-desc{color:var(--muted);font-size:.9rem;line-height:1.7;margin-bottom:1.2rem}
.modal-price{font-size:1.6rem;font-weight:800;color:var(--accent);font-family:'Space Mono',monospace;margin-bottom:1rem}
.modal-btns{display:flex;gap:.8rem}
.modal-close-btn{position:absolute;top:1rem;right:1rem;background:rgba(0,0,0,.5);border:none;color:var(--text);width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center}
.modal{position:relative}

/* TOAST */
.toast{position:fixed;bottom:2rem;right:2rem;background:#10b981;color:#fff;padding:.8rem 1.5rem;border-radius:10px;font-weight:700;font-size:.9rem;z-index:9999;transform:translateY(100px);opacity:0;transition:.3s}
.toast.show{transform:translateY(0);opacity:1}

@media(max-width:768px){
.nav-links{display:none;position:fixed;top:64px;left:0;right:0;background:var(--bg2);padding:1.5rem;flex-direction:column;border-bottom:1px solid var(--border)}
.nav-links.open{display:flex}
.hamburger{display:flex}
.hero h1{font-size:2.5rem}
.stats-row{gap:2rem}
}
</style>
</head>
<body>

<nav>
  <div class="logo">Xell<span>o</span>xx</div>
  <div class="nav-links" id="navLinks">
    <a href="#">Trang ch·ªß</a>
    <a href="#products">S·∫£n ph·∫©m</a>
    <a href="#" onclick="filterType('rent')">Cho thu√™ Bot</a>
    <a href="#" onclick="filterType('sell')">Mua File</a>
    <a href="/admin/login" class="btn btn-outline">Admin</a>
    <a href="/topup" class="btn btn-outline" style="color:var(--accent);border-color:rgba(255,106,0,.4)">üí∞ N·∫°p ti·ªÅn</a>
    <a href="/login" class="btn btn-primary" id="navLoginBtn">ƒêƒÉng nh·∫≠p</a>
  </div>
  <div class="hamburger" id="ham" onclick="toggleMenu()">
    <span></span><span></span><span></span>
  </div>
</nav>

<section class="hero">
  <div class="hero-bg"></div>
  <div class="hero-grid"></div>
  <div style="position:relative;z-index:1">
    <div class="badge">‚ö° #1 MARKETPLACE BOT VI·ªÜT NAM</div>
    <h1>KH√ÅM PH√Å<br><span class="hl">BOT & SOURCE</span><br>CH·∫§T L∆Ø·ª¢NG CAO</h1>
    <p>H√†ng trƒÉm bot, API, source code t·ª´ Zalo, Facebook ƒë·∫øn Discord. Ti·∫øt ki·ªám th·ªùi gian v·ªõi s·∫£n ph·∫©m s·∫µn s√†ng s·ª≠ d·ª•ng.</p>
    <div class="hero-btns">
      <a href="#products" class="btn btn-primary">üõí Mua ngay</a>
      <a href="#products" class="btn btn-outline" onclick="filterType('rent')">ü§ñ Thu√™ Bot</a>
    </div>
    <div class="stats-row" id="statsRow">
      <div class="stat"><div class="stat-num" id="sProducts">--</div><div class="stat-label">S·∫£n ph·∫©m</div></div>
      <div class="stat"><div class="stat-num" id="sUsers">--</div><div class="stat-label">Ng∆∞·ªùi d√πng</div></div>
      <div class="stat"><div class="stat-num" id="sOrders">--</div><div class="stat-label">ƒê∆°n h√†ng</div></div>
    </div>
  </div>
</section>

<!-- FILTERS -->
<div class="filters">
  <div class="filter-row">
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m..." onkeyup="searchProducts()">
      <button onclick="searchProducts()">üîç</button>
    </div>
    <button class="filter-btn active" id="fAll" onclick="filterCat('',this)">T·∫•t c·∫£</button>
    <button class="filter-btn" onclick="filterType('sell')">üõí Mua</button>
    <button class="filter-btn" onclick="filterType('rent')">‚è± Thu√™</button>
    <div id="catFilters"></div>
  </div>
</div>

<!-- FLASH SALE -->
<div class="flash-sale" id="flashSale">
  <div class="section-header">
    <div class="section-title">‚ö° Flash Sale <span class="fire">üî•</span></div>
    <div class="countdown">
      <div class="cd-box"><div class="cd-num" id="cdH">00</div><div class="cd-label">Gi·ªù</div></div>
      <div class="cd-sep">:</div>
      <div class="cd-box"><div class="cd-num" id="cdM">00</div><div class="cd-label">Ph√∫t</div></div>
      <div class="cd-sep">:</div>
      <div class="cd-box"><div class="cd-num" id="cdS">00</div><div class="cd-label">Gi√¢y</div></div>
    </div>
  </div>
  <div class="products-grid" id="saleGrid"></div>
</div>

<!-- ALL PRODUCTS -->
<div class="products-section" id="products">
  <div class="section-header">
    <div class="section-title">üì¶ T·∫•t c·∫£ s·∫£n ph·∫©m</div>
  </div>
  <div class="products-grid" id="productGrid"></div>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
  <div class="modal" id="modal">
    <button class="modal-close-btn" onclick="closeModal()">‚úï</button>
    <img class="modal-img" id="modalImg" src="" alt="">
    <div class="modal-body">
      <div class="modal-cat" id="modalCat"></div>
      <div class="modal-title" id="modalTitle"></div>
      <div class="modal-desc" id="modalDesc"></div>
      <div class="modal-price" id="modalPrice"></div>
      <div class="modal-btns">
        <button class="btn btn-primary" style="flex:1" onclick="buyNow()">üõí Mua ngay</button>
        <button class="btn btn-outline" onclick="closeModal()">ƒê√≥ng</button>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<footer>
  <div class="logo-footer">Xell<span>o</span>xx</div>
  <p>Marketplace Bot & Source Code h√†ng ƒë·∫ßu Vi·ªát Nam</p>
  <p style="margin-top:.5rem">¬© 2024 Xelloxx. All rights reserved.</p>
</footer>

<script>
let allProducts = [];
let currentFilter = {cat:'', type:'', search:''};

async function loadStats(){
  const r = await fetch('/api/stats');
  const d = await r.json();
  document.getElementById('sProducts').textContent = d.products+'+';
  document.getElementById('sUsers').textContent = d.users+'K+';
  document.getElementById('sOrders').textContent = d.orders+'+';
}

async function loadCategories(){
  const r = await fetch('/api/categories');
  const cats = await r.json();
  const el = document.getElementById('catFilters');
  el.innerHTML = cats.map(c=>`<button class="filter-btn" onclick="filterCat('${c}',this)">${c}</button>`).join('');
}

async function loadProducts(){
  const r = await fetch('/api/products');
  allProducts = await r.json();
  renderProducts(allProducts);
  renderSale(allProducts.filter(p=>p.sale_price>0));
}

function renderProducts(products){
  const g = document.getElementById('productGrid');
  if(!products.length){g.innerHTML='<p style="color:var(--muted);grid-column:1/-1;text-align:center;padding:3rem">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o üò¢</p>';return;}
  g.innerHTML = products.map(p=>cardHTML(p)).join('');
}

function renderSale(products){
  const g = document.getElementById('saleGrid');
  const section = document.getElementById('flashSale');
  if(!products.length){section.style.display='none';return;}
  section.style.display='block';
  g.innerHTML = products.map(p=>cardHTML(p)).join('');
}

function cardHTML(p){
  const imgEl = p.image 
    ? `<img class="card-img" src="${p.image}" alt="${p.name}" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">`
    : '';
  const placeholder = `<div class="card-img-placeholder" ${p.image?'style="display:none"':''}>ü§ñ</div>`;
  const saleTag = p.sale_price>0 ? `<span class="card-badge badge-sale">SALE</span>` : (p.price===0?`<span class="card-badge badge-free">FREE</span>`:'');
  const typeTag = `<span class="card-type type-${p.type}">${p.type==='rent'?'‚è± Cho thu√™':'üõí B√°n'}</span>`;
  const price = p.sale_price>0
    ? `<div class="price-current">${fmt(p.sale_price)}ƒë</div><div class="price-old">${fmt(p.price)}ƒë</div>`
    : `<div class="price-current">${p.price===0?'FREE':fmt(p.price)+'ƒë'}</div>`;
  return `<div class="product-card" onclick="openModal('${p.id}')">
    ${imgEl}${placeholder}${saleTag}
    <div class="card-body">
      <div style="display:flex;gap:.5rem;align-items:center;margin-bottom:.3rem">${typeTag}<span class="card-cat">${p.category}</span></div>
      <div class="card-name">${p.name}</div>
      <div class="card-desc">${p.description}</div>
      <div class="card-footer">
        <div class="price-box">${price}</div>
        <button class="btn-buy" onclick="event.stopPropagation();buyProduct('${p.id}')">Mua ngay</button>
      </div>
    </div>
  </div>`;
}

function fmt(n){return new Intl.NumberFormat('vi-VN').format(n);}

async function openModal(id){
  const r = await fetch('/api/products/'+id);
  const p = await r.json();
  document.getElementById('modalImg').src = p.image||'';
  document.getElementById('modalImg').style.display = p.image?'block':'none';
  document.getElementById('modalCat').textContent = p.category+' ¬∑ '+(p.type==='rent'?'Cho thu√™':'B√°n file');
  document.getElementById('modalTitle').textContent = p.name;
  document.getElementById('modalDesc').textContent = p.description;
  const priceVal = p.sale_price>0?p.sale_price:p.price;
  document.getElementById('modalPrice').textContent = priceVal===0?'FREE':fmt(priceVal)+'ƒë';
  document.getElementById('modal').dataset.id = id;
  document.getElementById('modalOverlay').classList.add('open');
}

function closeModal(e){
  if(!e||e.target===document.getElementById('modalOverlay'))
    document.getElementById('modalOverlay').classList.remove('open');
}

function buyNow(){
  const id = document.getElementById('modal').dataset.id;
  buyProduct(id);
  closeModal();
}

async function buyProduct(id){
  const res = await fetch('/api/me');
  const user = await res.json();
  if(!user.ok){
    showToast('üõí Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ mua h√†ng!','error');
    setTimeout(()=>window.location.href='/login',1500);
    return;
  }
  window.location.href = '/checkout?product='+id;
}

function showToast(msg,type='success'){
  const t = document.getElementById('toast');
  t.textContent=msg;
  t.style.background=type==='success'?'#10b981':'#ef4444';
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),3000);
}

function filterCat(cat,btn){
  currentFilter.cat=cat;
  currentFilter.type='';
  document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
  if(btn)btn.classList.add('active');
  applyFilter();
}

function filterType(type){
  currentFilter.type=type;
  currentFilter.cat='';
  document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
  applyFilter();
}

function searchProducts(){
  currentFilter.search=document.getElementById('searchInput').value.toLowerCase();
  applyFilter();
}

function applyFilter(){
  let p=allProducts;
  if(currentFilter.cat) p=p.filter(x=>x.category===currentFilter.cat);
  if(currentFilter.type) p=p.filter(x=>x.type===currentFilter.type);
  if(currentFilter.search) p=p.filter(x=>x.name.toLowerCase().includes(currentFilter.search)||x.description.toLowerCase().includes(currentFilter.search));
  renderProducts(p);
  document.getElementById('products').scrollIntoView({behavior:'smooth'});
}

// Countdown: next midnight
function startCountdown(){
  const end = new Date(); end.setHours(24,0,0,0);
  setInterval(()=>{
    const diff = end-Date.now();
    if(diff<=0)return;
    const h=Math.floor(diff/3600000),m=Math.floor((diff%3600000)/60000),s=Math.floor((diff%60000)/1000);
    document.getElementById('cdH').textContent=String(h).padStart(2,'0');
    document.getElementById('cdM').textContent=String(m).padStart(2,'0');
    document.getElementById('cdS').textContent=String(s).padStart(2,'0');
  },1000);
}

function toggleMenu(){document.getElementById('navLinks').classList.toggle('open');}

loadStats(); loadCategories(); loadProducts(); startCountdown();
</script>
</body>
</html>
